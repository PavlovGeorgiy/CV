--=============== ������ 2. ������ � ������ ������ =======================================
--= �������, ��� ���������� ���������� ������ ���������� � ������� ����� PUBLIC===========
SET
search_path TO public;
--======== �������� ����� ==============;
--������� �1
--�������� ���������� �������� ������� �� ������� �������.
SELECT
	DISTINCT city
FROM
	city c;
--������� �2
--����������� ������ �� ����������� �������, ����� ������ ������� ������ �� ������,
--�������� ������� ���������� �� �L� � ������������� �� �a�, � �������� �� �������� ��������.
SELECT
	DISTINCT city
FROM
	city c
WHERE
	city LIKE 'L%a'
	AND city NOT LIKE '% %';
--������� �3
--�������� �� ������� �������� �� ������ ������� ���������� �� ��������, ������� ����������� 
--� ���������� � 17 ���� 2005 ���� �� 19 ���� 2005 ���� ������������, 
--� ��������� ������� ��������� 1.00.
--������� ����� ������������� �� ���� �������.
SELECT
	payment_id,
	amount AS "�����",
	payment_date AS "���� �������"
FROM
	payment p
WHERE
	payment_date BETWEEN '2005-06-17' AND '2005-06-20'
	AND amount > 1.00
ORDER BY
	payment_date DESC;
--������� �4
-- �������� ���������� � 10-�� ��������� �������� �� ������ �������.
SELECT
	payment_id,
	payment_date::date,
	amount
FROM
	payment p
ORDER BY
	payment_date ASC
LIMIT (10);
--������� �5
--�������� ��������� ���������� �� �����������:
--  1. ������� � ��� (� ����� ������� ����� ������)
--  2. ����������� �����
--  3. ����� �������� ���� email
--  4. ���� ���������� ���������� ������ � ���������� (��� �������)
--������ ������� ������� ������������ �� ������� �����.
SELECT
	concat(
		first_name,
		' ',
		last_name
	) AS "��� �������",
	email AS "�����" ,
	character_length(email) AS "����� �����",
	last_update::date AS "��������� ����������"
FROM
	customer c;
--������� �6
--�������� ����� �������� ������ �������� �����������, ����� ������� KELLY ��� WILLIE.
--��� ����� � ������� � ����� �� �������� �������� ������ ���� ���������� � ������ �������.
SELECT
	customer_id AS id,
	lower(first_name) AS "���"
FROM
	customer c
WHERE
	first_name = 'KELLY'
	OR first_name = 'WILLIE'
	AND activebool = 'true'
